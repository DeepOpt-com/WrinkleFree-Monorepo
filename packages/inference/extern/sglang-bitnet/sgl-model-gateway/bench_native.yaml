name: wf-server-bench

file_mounts:
  /workspace/wf_server: ./target/release/wf_server
  /workspace/bitnet-2b-i2s.gguf: /home/lev/code/WrinkleFreeDevWrapper/GetDistillWorking/extern/BitNet/models/BitNet-b1.58-2B-4T-gguf/ggml-model-i2_s.gguf

run: |
  set -ex
  chmod +x /workspace/wf_server

  echo "=== Running WF Server Prefill Benchmark ==="
  echo "Model: BitNet 2B I2_S"
  echo "CPU: $(lscpu | grep 'Model name' | cut -d: -f2 | xargs)"
  echo ""

  # Run benchmark mode (prefill only)
  /workspace/wf_server \
    --model-path /workspace/bitnet-2b-i2s.gguf \
    --port 30000 \
    --benchmark \
    --benchmark-seq-len 512 \
    --benchmark-iterations 10
